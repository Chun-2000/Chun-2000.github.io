<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">


        <link rel="stylesheet" href="Hackathon-1_HW3.css">

        <link rel="stylesheet" type="text/css" href="../advanced-notification-sound-effects-pexxalert/pexx.alert.css">
        <!-- <script type="text/javascript" src="path-to-js/jquery.js"></script> -->
        <script type="text/javascript" src="../advanced-notification-sound-effects-pexxalert/pexx.alert.js"></script>

        <title>幾A幾B</title>
    </head>
    <body>
        

        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

        <script src="https://kit.fontawesome.com/1a54ee6640.js" crossorigin="anonymous"></script>


        
        <div class="container">
            <h1>Guess Number 1A2B</h1>
            <div class="btn-group" role="group" aria-label="Basic outlined example">
                <button type="button" class="btn btn-outline-secondary" id="start">開始</button>
                <button type="button" class="btn btn-outline-secondary" id="replay">放棄重來</button>
                <button type="button" class="btn btn-outline-secondary" id="solution">看答案</button>
            </div>
            
            

            <ul class="list-group list-group-flush border" style="overflow:auto; height: 150px;">
                <li class="list-group-item"><span class="badge bg-success">Success</span>An item</li>
                <li class="list-group-item"><span class="badge bg-danger">Danger</span>A second item</li>
                <li class="list-group-item">A third item</li>
                <li class="list-group-item">A fourth item</li>
                <li class="list-group-item">And a fifth one</li>
                <li class="list-group-item"><span class="badge bg-success">Success</span>An item</li>
                <li class="list-group-item">A second item</li>
                <li class="list-group-item">A third item</li>
                <li class="list-group-item">A fourth item</li>
                <li class="list-group-item">And a fifth one</li>
                <li class="list-group-item"><span class="badge bg-success">Success</span>An item</li>
                <li class="list-group-item">A second item</li>
                <li class="list-group-item">A third item</li>
                <li class="list-group-item">A fourth item</li>
                <li class="list-group-item">And a fifth one</li>
            </ul>

            <div class="input-group was-validated">
                <label class="input-group-text" for="inputGroupSelect01">猜答案</label>
                <input type="text" class="input form-control is-invalid" type="password" aria-label="Text input with segmented dropdown button" placeholder="請輸入四個不同數字" maxlength="4" minlength="4" disabled required>
                <button class="guess btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">猜!</button>
            </div>

            

            

            <!-- <div class="spinner-border text-secondary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow spinner-grow-sm text-secondary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div> -->

        </div>

        <script>

            let TextArea = document.querySelector(".list-group");

            let start = document.getElementById("start");
            let replay = document.getElementById("replay");
            let solution = document.getElementById("solution");

            let input = document.querySelector(".input");
            let guess = document.querySelector(".guess");

            let correct_answer = 0;
            let numberArray = []; //typeof(numberArray) = object
            let A = 0;
            let B = 0;
            reset();

            start.addEventListener('click',()=>{
                unlock();
                correct_answer = Random4Number();
            });

            replay.addEventListener('click',()=>{
                reset();
            });

            solution.addEventListener('click',()=>{
                alert(`答案為 ${correct_answer}`);
            });

            guess.addEventListener('click',()=>{
                guess.innerHTML = `<div class="spinner-grow spinner-grow-sm text-secondary" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>`;
                
                //字串轉陣列 + 判斷是否重複字元 => 如果傳回為 true 表示重複字元
                if(CheckIsRepeatChar(Change(input.value)) == true){
                    alert("錯誤!請輸入四個不同數字");
                }
                else{
                    if(correct_answer === input.value){
                        guess.innerText = "猜!"; 
                        alert(`恭喜你答對了~\n5秒後更新`);
                        TextArea.innerHTML += `<li class="list-group-item"><span class="badge bg-success">4A0B</span>${input.value}</li>`;
                        setTimeout(`alert('重新開始!'); reset();`,5000);
                        
                    }
                    else{
                        CheckIsDifferent4Char(Change(input.value),Change(correct_answer));
                        guess.innerText = "猜!";
                        TextArea.innerHTML += `<li class="list-group-item"><span class="badge bg-danger">${A}A${B}B</span>${input.value}</li>`;
                    }
                }
            });

            function reset(){
                TextArea.innerText = "";
                input.value = "";
                start.removeAttribute('disabled');
                replay.setAttribute('disabled', true);
                solution.setAttribute('disabled', true);
                input.setAttribute('disabled', true);
                input.removeAttribute('is-invalid');
            }

            function unlock(){
                start.setAttribute('disabled', true);
                replay.removeAttribute('disabled');
                solution.removeAttribute('disabled');
                input.removeAttribute('disabled');
                
            }

            function Random4Number() {
                randomList = Math.floor(Math.random() * 9) + 1;

                var solution = '';
                //宣告一個變數用來裝隨機產生的數字
                var n = 0;
                for(i=0;i<4;i++){
                    //產生0~9數字
                    n = Math.floor(Math.random() * 9);
                    //用indexOf判斷該數字之前有沒有出現過
                    if(solution.indexOf(`${n}`)!= -1){ //因為 typeof(n) = number 所以要將其改為字串(如果不用這招就會判斷錯誤)
                        //如果有出現過就重跑一次迴圈
                        i-=1;//扣除一步
                        debugger;
                        continue;
                    }
                    else{
                        //沒出現過的話就寫進字串裡
                        solution += n;
                    };
                };
                return solution;
            };
        
            function Change(numberString){
                numberArray = numberString.split(''); //將字串切開加入Array
                return numberArray;
            }

            function CheckIsRepeatChar(arr){
                let nary=arr.sort();

                for(let i=0;i<arr.length;i++){

                    if (nary[i] == nary[i+1]){

                        alert("錯誤! 陣列重複內容: "+ nary[i]);
                        return true;

                    }

                }
                return false;
            }

            function CheckIsDifferent4Char(input, answer){

                A = 0,B = 0;

                for(let i=0;i<4;i++){
                    //如果答案包含輸入字元 B++
                    if (answer.includes(input[i])){
                        // alert("答案包含輸入字元: " + input[i]);
                        B++;
                    }
                }
                for(let i=0;i<4;i++){
                    //如果連位子都完全符合 A++,B--
                    if (input[i] === answer[i]){
                        // alert("陣列相同位子內容: " + input[i]);
                        A++;
                        B--;
                    }
                }
            }


        </script>
    </body>
</html>